# 📋 Todo 计划

---

## ⚡ 编排器优化（Orchestrator）

### 已完成 ✅
- [x] **短期优化**：调整延迟时间配置（v1.18.3.5）
- [x] **短期优化**：分批注册 High 阶段任务（v1.18.3.5）
- [x] **短期优化**：缩短 Idle 超时时间（v1.18.3.5）
- [x] **中期优化**：任务优先级系统（v1.18.3.8）
- [x] **中期优化**：动态并发调整（v1.18.3.8）
- [x] **中期优化**：性能指标收集（v1.18.3.8）

### 待实施优化

#### 🔴 高优先级（建议1-2周内完成）

- [ ] **任务依赖关系管理**
  - **优先级**: P0（高）
  - **工作量**: 2-3天
  - **好处**: 
    - 确保任务按正确顺序执行
    - 避免依赖未就绪导致的错误
    - 更清晰的任务关系图
  - **实现方式**: 
    ```typescript
    initOrchestrator.add('high', task, { 
      label: 'task-b', 
      dependsOn: ['task-a'] 
    });
    ```

- [ ] **Dashboard 性能监控面板**
  - **优先级**: P0（高）
  - **工作量**: 1-2天
  - **好处**:
    - 可视化任务执行时间
    - 识别性能瓶颈
    - 提供优化建议
    - 帮助用户了解扩展性能
  - **展示内容**:
    - 任务执行时间分布图
    - 各阶段耗时统计
    - 慢任务识别（>100ms）
    - 失败任务列表

- [ ] **任务超时检测**
  - **优先级**: P1（中高）
  - **工作量**: 1天
  - **好处**:
    - 防止任务无限期阻塞
    - 自动识别异常任务
    - 提高系统稳定性
  - **实现方式**:
    ```typescript
    initOrchestrator.add('high', task, { 
      label: 'task', 
      timeout: 5000 // 5秒超时
    });
    ```

#### 🟡 中优先级（建议1个月内完成）

- [ ] **任务取消机制**
  - **优先级**: P2（中）
  - **工作量**: 2天
  - **好处**:
    - 页面切换时取消不需要的任务
    - 节省资源
    - 提高响应速度
  - **使用场景**:
    - 用户快速切换页面
    - 扩展卸载时清理
    - 手动停止某些任务

- [ ] **任务重试机制**
  - **优先级**: P2（中）
  - **工作量**: 1-2天
  - **好处**:
    - 自动重试失败的任务
    - 提高成功率
    - 减少用户手动干预
  - **实现方式**:
    ```typescript
    initOrchestrator.add('high', task, { 
      label: 'task', 
      maxRetries: 3,
      retryDelay: 1000
    });
    ```

- [ ] **任务分组管理**
  - **优先级**: P2（中）
  - **工作量**: 1天
  - **好处**:
    - 按功能模块分组任务
    - 批量控制任务执行
    - 更清晰的任务组织
  - **实现方式**:
    ```typescript
    initOrchestrator.addGroup('privacy', [
      { task: task1, options: {...} },
      { task: task2, options: {...} }
    ]);
    ```

- [ ] **条件执行支持**
  - **优先级**: P2（中）
  - **工作量**: 1天
  - **好处**:
    - 根据条件动态决定是否执行
    - 减少不必要的任务执行
    - 更灵活的任务控制
  - **实现方式**:
    ```typescript
    initOrchestrator.add('high', task, { 
      label: 'task',
      condition: () => settings.enabled
    });
    ```

#### 🟢 低优先级（长期规划）

- [ ] **任务执行历史记录**
  - **优先级**: P3（低）
  - **工作量**: 2天
  - **好处**:
    - 保存历史执行记录
    - 分析性能趋势
    - 问题追溯
  - **存储方式**: IndexedDB

- [ ] **任务执行预测**
  - **优先级**: P3（低）
  - **工作量**: 3天
  - **好处**:
    - 预测任务执行时间
    - 优化任务调度
    - 提供进度估算
  - **实现方式**: 基于历史数据的机器学习

- [ ] **任务并行度自适应**
  - **优先级**: P3（低）
  - **工作量**: 2天
  - **好处**:
    - 根据系统负载动态调整
    - 更智能的资源利用
    - 避免过载
  - **监控指标**: CPU使用率、内存占用

- [ ] **任务执行可视化动画**
  - **优先级**: P3（低）
  - **工作量**: 2-3天
  - **好处**:
    - 实时显示任务执行状态
    - 更好的用户体验
    - 调试更直观
  - **展示方式**: 流程图、甘特图

---

## 🔐 115 功能


---

## 🎨 功能增强


- [ ] 聚合
- [ ] 符合 emby 的页面番号识别功能（在影片页面方便识别网友评论中的经典番号）
- [x] 右击后台打开，支持影片页"你可能也喜歡"
- [x] “正在获取增强信息...”的提示框位置与样式优化

---

## 🆕 新作品
- [x] 新作品的添加演员按钮，弹窗列出的列表不能包含拉黑的演员
- [x] 设置里面增加并发功能，在检查新作品的时候多并发去检查
- [x] 优化添加演员弹窗的宽度和高度
- [ ] 新作品的添加演员按钮，弹窗列出的列表添加标识，是不包含拉黑的演员

---

## ☁️ WebDAV 设置


---

## 📝 日志设置

- [ ] 检查所有功能增强时候有独立的标识

---

## 🔄 数据同步


---

## 🎬 番号库

- [x] 增加番号的基础信息的结构体，保存星级和用户自定义评分，导演、片商
- [x] 增加“我的收藏”功能在番号库增加爱心图标，和“我的收藏”tab 页面，点击后就显示收藏列表

---

## 演员库

- [ ] 演员库新增演员更多信息（可通过增强功能的去wiki获取保存）
- [ ] 优化列表视图和卡片视图的切换

---

## 📊 报告

- [ ] 报告（Insights）设置 
  配置报告生成所用的聚合参数，仅影响本地统计、AI 提示词输入。

> **优化建议：** 这里面的配置，太过于专业化，能不能优化一下，对使用者友好一点。然后优化配置项的排列布局样式

---

## 🎥 Emby

- [ ] 功能优化
