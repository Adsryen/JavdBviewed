# 📋 Todo 计划

---

## 🔐 115 功能

- [ ] refreshtoken 增加有效状态，合理进行控制自动刷新

---

## ⚡ 功能增强

### 🔴 未开启的功能

- [ ] 聚合
- [ ] 缓存
- [ ] 优化列表页的影片卡片的快捷按钮：已阅（已看、想看没必要了）
- [ ] 符合 emby 的页面番号识别功能（在影片页面方便识别网友评论中的经典番号）

### 🟢 已开启的功能

- [ ] 略缩图跳转存在无效的问题，与跳转至网页中间位置
- [ ] 加载上次应用的标签，未生效
- [ ] 智能内容过滤，增加正则配置时的动态检测与提示。在处理后，需要使用 toast 输出总结数据：高亮 n 个，隐藏 m 个等等
- [ ] 调整"预览来源"的选择
- [ ] **🔓 破解评论区** 和 **🚫 破解 FC2 拦截** 功能（**待验证**）
  - 评论区显示的位置有问题，应该适配原有位置和样式，并且有 400 报错，需要修复
  - FC2 没有效果，需要修复，也没看到具体失败的错误信息
  - 统一翻译模块内的伪 MD5（translator.ts）为 md5Hex()
  - 后台代理增加 per-host 限频与短时缓存，进一步稳健
- [ ] 右击后台打开，支持影片页的"你可能也喜歡"
- [ ] 磁力资源搜索的控制增加，当影片处于番号库已看的状态，默认不加载磁力资源（减少性能使用），改为在磁力来源显示的位置，增加一个手动开始搜索的按钮
- [ ] 智能内容过滤，增加作用字段“发行日期”，可以通过判断“发行日期”的范围来识别并执行动作

---

## 🆕 新作品

- [ ] 优化已读作品的删除（**待验证**）
- [ ] 批量打开未读新作品（**待验证**）
- [ ] 排除标签：單體作品 含磁鏈（**待验证**）
- [ ] 检查新作品，需要根据现有番号库重新刷新过滤，自需要获取不在番号库（不管状态）的新作品（**待验证**）

---

## 📋 列表显示设置

- [ ] 演员过滤（列表），不能在演员页生效，不然会影响演员页的数据显示（比如标题没有在演员库，但是实际上这个数据是属于这个演员的，也就是之前提到的标题匹配会存在的误差，所以这个演员页，这个功能下面的三个筛选按钮功能都不能生效）（**待验证**）

---

## ☁️ WebDAV 设置

- [ ] 自动上传的功能失效了（**待验证**）

---

## 📝 日志设置

- [ ] 检查所有功能增强时候有独立的标签

---

## 🔄 数据同步

- [x] 清单同步数据一致性问题修复
  - [x] 清单删除后，本地数据库同步删除
  - [x] 影片从清单移除后，listIds 正确更新
  - [x] 同步前显示变更预览，用户确认后执行
  - [x] 区分新增、更新、删除三种操作
  - [x] 清理孤儿影片的清单关联

---

## 🎬 番号库

- [ ] 编辑按钮保存的时候需要校验表单和json是否一致，不一致需要提示用户，并给出提示信息，让用户手动同步两侧，以表单还是json为准进行保存
- [ ] 增加点击"想看"按钮，更新番号库影片状态，如果番号库没有该影片，则添加（**待验证**）
  - [ ] 需要点击"删除"按钮，状态更新为"已浏览"
  - [ ] 点击"看过"按钮，状态更新为"已观看"
- 清单
  - [x] 同步javdb的清单列表，数据同步页面需要有同步按钮
  - [x] 为番号库中的影片新增 清单 归属，每个影片可以归属于多个清单
  - [x] 在番号库页面，增加清单筛选功能
  - [x] 番号库新增一个子页面，用于管理清单列表，清单可点击查看下面的影片，与番号库的清单搜索共存；番号库的影片列表新增显示方式（类似tag那种感觉？）
  - [x] 清单为空时不跳转到番号库
  - [x] 番号库添加导出数据功能（支持Excel和JSON格式）
  - [x] 导出功能支持显示进度（数据量>1000时）
  - [x] 导出功能支持筛选条件（导出当前查询结果）
---

## 📊 报告

- [ ] 报告（Insights）设置  
  配置报告生成所用的聚合参数，仅影响本地统计与 AI 提示词输入。

> **优化建议：** 这里面的配置，太过于专业化，能不能优化一下，对使用者友好一点。然后优化配置项的排列布局样式

---

## 🎥 Emby

- [ ] 功能优化

---

## 🔧 其他

- [ ] 尽可能分批次生成 commit msg，按功能分批，不用太细化，但是 msg 与标题要匹配上，最好直接给我 git 命令
